
OPCLIMBER

	LDX MOUSELEM
	LDA 5,X
	BNE OPCLIMBER1

	LDA 2,X
	BEQ OPCLIMBER1

	LDA #1
	STA 5,X

	LDX #LEVCNT
	DEC 2,X

OPCLIMBER1

	RTS


OPFLOATER

	LDX MOUSELEM
	LDA 6,X
	BNE OPFLOATER1

	LDA 3,X
	BEQ OPFLOATER1

	LDA #1
	STA 6,X

	LDX #LEVCNT
	DEC 3,X

OPFLOATER1

	RTS

OPBOMBER

	LDX #LEVCNT
	LDA 4,X
	BEQ OPBOMBER1

	LDX MOUSELEM
	LDA 8,X
	BNE OPBOMBER1
	LDA 4,X
	CMPA #36
	BEQ OPBOMBER1


	LDA #5*16
	STA 8,X

	LDX #LEVCNT
	DEC 4,X

OPBOMBER1

	RTS


OPSTOPPER

	LDX MOUSELEM
	LDA 4,X
	CMPA #2
	BEQ OPSTOPPER1
	CMPA #4
	BEQ OPSTOPPER1
	RTS

OPSTOPPER1

	LDY #LEVCNT
	LDA 5,Y
	LBEQ OPSTOPPERFIN

	DEC 5,Y

	LDA #28
	STA 4,X
	CLR 3,X

	LDA #4
	STA $E7E5

	JSR VIRECR
	LEAY 10*40,Y

	LSLB
	LDU #STOPTAB
	LEAU B,U

	LDD ,U
	ORA ,Y
	ORB 1,Y
	STD ,Y

	LDD ,U
	ORA -40,Y
	ORB -40+1,Y
	STD -40,Y

	LDD ,U
	ORA -80,Y
	ORB -80+1,Y
	STD -80,Y

	LDD ,U
	ORA -120,Y
	ORB -120+1,Y
	STD -120,Y

	LDD ,U
	ORA -160,Y
	ORB -160+1,Y
	STD -160,Y

	LDD ,U
	ORA -200,Y
	ORB -200+1,Y
	STD -200,Y

	LDD ,U
	ORA -240,Y
	ORB -240+1,Y
	STD -240,Y

	LDD ,U
	ORA -280,Y
	ORB -280+1,Y
	STD -280,Y

	LDD ,U
	ORA -320,Y
	ORB -320+1,Y
	STD 6320,Y

OPSTOPPERFIN

	RTS

STOPTAB
	FDB $2000,$1000,$0800,$0400
	FDB $0200,$0100,$0080,$0040



OPBRIDGE

	LDX MOUSELEM
	LDA 4,X
	CMPA #2
	BEQ OPBRIDGE1
	CMPA #4
	BEQ OPBRIDGE2
	CMPA #24
	BEQ OPBRIDGE1
	CMPA #20
	BEQ OPBRIDGE2

	RTS

OPBRIDGE1

	LDY #LEVCNT
	LDA 6,Y
	BEQ OPBRIDGEFIN
	DEC 6,Y

	LDA #22
	STA 4,X
	LDA #10
	STA 7,X
	CLR 3,X
	DEC 2,X
	DEC 2,X
	DEC 2,X
	RTS

OPBRIDGE2

	LDY #LEVCNT
	LDA 6,Y
	BEQ OPBRIDGEFIN
	DEC 6,Y

	LDA #18
	STA 4,X
	LDA #10
	STA 7,X
	CLR 3,X
	DEC 2,X
	DEC 2,X
	DEC 2,X

OPBRIDGEFIN

	RTS


OPBASHER

	LDY #LEVCNT
	LDA 7,Y
	BNE OPBASHER1
	RTS

OPBASHER1

	LDX MOUSELEM
	LDA 4,X
	CMPA #4
	BEQ OPBASHER2
	CMPA #2
	BEQ OPBASHER3

	RTS

* BASH RIGHT

OPBASHER2

	DEC 7,Y
	LDA #42
	STA 4,X
	CLR 3,X
	INC 2,X

	RTS


* BASH LEFT

OPBASHER3

	DEC 7,Y
	LDA #44
	STA 4,X
	CLR 3,X
	INC 2,X
	RTS

OPDIGGER

	LDY #LEVCNT
	LDA 8,Y
	BNE OPDIGGER1
	RTS

OPDIGGER1


	LDX MOUSELEM
	LDA 4,X
	CMPA #4
	BEQ OPDIGGER2
	CMPA #2
	BEQ OPDIGGER3

	RTS

* DIG RIGHT
OPDIGGER2

	DEC 8,Y
	LDA #38
	STA 4,X
	CLR 3,X
	DEC 2,X
	DEC 2,X
	RTS

* DIG LEFT
OPDIGGER3

	DEC 8,Y
	LDA #40
	STA 4,X
	CLR 3,X
	DEC 2,X
	DEC 2,X
	RTS





OPDIGGERV

	LDX MOUSELEM
	LDA 4,X
	CMPA #2
	BEQ OPDIGGERV1
	CMPA #4
	BEQ OPDIGGERV1

	RTS

OPDIGGERV1

	LDY #LEVCNT
	LDA 9,Y
	BEQ OPDIGGERVFIN
	DEC 9,Y

	LDA #26
	STA 4,X
	CLR 3,X
	DEC 2,X
	DEC 2,X


OPDIGGERVFIN
	RTS


SELECTOPA FCB 0
SELECTOPB FCB 0
SELECTOPX FDB 0
SELECTOPY FDB 0




SELECTOPTION


*** RESTORE ALL OPTIONS


	LDX #176*40
	STX SELECTEDOPPATCH1+1
	LDX #$2000+176*40
	STX SELECTEDOPPATCH1+5

	JSR SCRCRAM
	JSR SELECTEDOPTION0
	JSR SCRCRAM
	JSR SELECTEDOPTION0

	LDX #$C000+176*40
	STX SELECTEDOPPATCH1+1
	LDX #$A000+176*40
	STX SELECTEDOPPATCH1+5

	LDA #$05
	STA $E7E5


SELECTEDOPTION0

* JSR RESTMOUSE

SELECTEDOPPATCH1

	LDX #176*40
	LDY #$2000+176*40

* LINE 1

	LDB #$1F
	STB ,X
	STB ,Y
	LDD #$FFFF
	STD 1,X
	STD 3,X
	STD 5,X
	STD 7,X
	STD 9,X
	STD 11,X
	STD 13,X
	STD 15,X
	STD 17,X
	STD 19,X
	STD 21,X
	STA 23,X
	LDA #$F0
	STA 24,X

* LINE 2 - 24

	LDA #22

SELECTEDOP1

	LEAX 40,X
	LEAY 40,Y
* OP 1
	LDB ,Y
	ANDB #$F7
	STB ,Y
	LDB 2,X
	ORB #$10
	STB 2,X
* OP 2
	LDB 2,Y
	ANDB #$F7
	STB 2,Y
	LDB 4,X
	ORB #$10
	STB 4,X
* OP 3
	LDB 4,Y
	ANDB #$F7
	STB 4,Y
	LDB 6,X
	ORB #$10
	STB 6,X
* OP 4
	LDB 6,Y
	ANDB #$F7
	STB 6,Y
	LDB 8,X
	ORB #$10
	STB 8,X
* OP 5
	LDB 8,Y
	ANDB #$F7
	STB 8,Y
	LDB 10,X
	ORB #$10
	STB 10,X
* OP 6
	LDB 10,Y
	ANDB #$F7
	STB 10,Y
	LDB 12,X
	ORB #$10
	STB 12,X
* OP 7
	LDB 12,Y
	ANDB #$F7
	STB 12,Y
	LDB 14,X
	ORB #$10
	STB 14,X
* OP 8
	LDB 14,Y
	ANDB #$F7
	STB 14,Y
	LDB 16,X
	ORB #$10
	STB 16,X
* OP 9
	LDB 16,Y
	ANDB #$F7
	STB 16,Y
	LDB 18,X
	ORB #$10
	STB 18,X
* OP 10
	LDB 18,Y
	ANDB #$F7
	STB 18,Y
	LDB 20,X
	ORB #$10
	STB 20,X
* OP 11
	LDB 20,Y
	ANDB #$F7
	STB 20,Y
	LDB 22,X
	ORB #$10
	STB 22,X
* OP 12
	LDB 22,Y
	ANDB #$F7
	STB 22,Y
	LDB 24,X
	ORB #$10
	STB 24,X

	DECA
	LBNE SELECTEDOP1

* LAST LINE

	LEAX 40,X
	LEAY 40,Y

	LDD #$1000
	STD ,Y
	STA ,X
	STD 2,Y
	STA 2,X
	STD 4,Y
	STA 4,X
	STD 6,Y
	STA 6,X
	STD 8,Y
	STA 8,X
	STD 10,Y
	STA 10,X
	STD 12,Y
	STA 12,X
	STD 14,Y
	STA 14,X
	STD 16,Y
	STA 16,X
	STD 18,Y
	STA 18,X
	STD 20,Y
	STA 20,X
	STD 22,Y
	STA 22,X



* PRINT SELECTED OPTION

	LDB SELECTEDOP

SELECTEDOPPATCH2

	LDX SELECTEDOPPATCH1+5
	ABX
	TFR X,Y
	LDX SELECTEDOPPATCH1+1
	ABX

	LDB ,X
	ANDB #$F0
	STB ,X

	CLR 1,X

	LDB 2,X
	ANDB #$0F
	STB 2,X

	LDA #22

SELECTOP2

	LEAX 40,X
	LEAY 40,Y

	LDB ,Y
	ORB #$08
	STB ,Y

	LDB 2,X
	ANDB #$EF
	STB 2,X

	DECA
	BNE SELECTOP2

	LDB 40,Y
	ORB #$0F
	STB 40,Y

	LDB #$FF
	STB 41,Y

	LDB 42,Y
	ORB #$F0
	STB 42,Y

	CLR 42,X

	RTS


DECEXIT

	LDX #LEVCNT

	LDA 1,X
	CMPA #1
	BLS DECEXIT1

	INC ,X
	DEC 1,X

DECEXIT1


	RTS



INCEXIT

	LDX #LEVCNT
	LDA ,X
	CMPA #1
	BLS INCEXIT1

	DEC ,X
	INC 1,X

INCEXIT1

	RTS



OPTION FDB NOTHING,NOTHING
	FDB OPCLIMBER
	FDB OPFLOATER,OPBOMBER
	FDB OPSTOPPER,OPBRIDGE
	FDB OPBASHER,OPDIGGER
	FDB OPDIGGERV,NOTHING
	FDB NOTHING
